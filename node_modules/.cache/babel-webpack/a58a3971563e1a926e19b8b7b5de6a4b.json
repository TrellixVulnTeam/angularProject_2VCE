{"ast":null,"code":"\"use strict\";\n\nvar _toConsumableArray = require(\"/Users/abdillahihussein/Documents/GitHub/angularProject/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getServerConfig = void 0;\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nvar path_1 = require(\"path\");\n\nvar webpack_1 = require(\"webpack\");\n\nvar webpack_version_1 = require(\"../../utils/webpack-version\");\n\nvar helpers_1 = require(\"../utils/helpers\");\n/**\n * Returns a partial Webpack configuration specific to creating a bundle for node\n * @param wco Options which include the build options and app config\n */\n\n\nfunction getServerConfig(wco) {\n  var _wco$buildOptions = wco.buildOptions,\n      sourceMap = _wco$buildOptions.sourceMap,\n      bundleDependencies = _wco$buildOptions.bundleDependencies,\n      _wco$buildOptions$ext = _wco$buildOptions.externalDependencies,\n      externalDependencies = _wco$buildOptions$ext === void 0 ? [] : _wco$buildOptions$ext;\n  var extraPlugins = [];\n  var scripts = sourceMap.scripts,\n      styles = sourceMap.styles,\n      hidden = sourceMap.hidden;\n\n  if (scripts || styles) {\n    extraPlugins.push(helpers_1.getSourceMapDevTool(scripts, styles, hidden));\n  }\n\n  var externals = _toConsumableArray(externalDependencies);\n\n  if (!bundleDependencies) {\n    if (webpack_version_1.isWebpackFiveOrHigher()) {\n      var hook = function hook(_ref, callback) {\n        var context = _ref.context,\n            request = _ref.request;\n        return externalizePackages(request, context, callback);\n      };\n\n      externals.push(hook);\n    } else {\n      externals.push(externalizePackages);\n    }\n  }\n\n  var config = {\n    resolve: {\n      mainFields: ['es2015', 'main', 'module']\n    },\n    target: 'node',\n    output: {\n      libraryTarget: 'commonjs'\n    },\n    plugins: [// Fixes Critical dependency: the request of a dependency is an expression\n    new webpack_1.ContextReplacementPlugin(/@?hapi(\\\\|\\/)/), new webpack_1.ContextReplacementPlugin(/express(\\\\|\\/)/)].concat(extraPlugins),\n    node: false,\n    externals: externals\n  };\n  return config;\n}\n\nexports.getServerConfig = getServerConfig;\n\nfunction externalizePackages(context, request, callback) {\n  // Absolute & Relative paths are not externals\n  if (request.startsWith('.') || path_1.isAbsolute(request)) {\n    callback();\n    return;\n  }\n\n  try {\n    require.resolve(request, {\n      paths: [context]\n    });\n\n    callback(undefined, request);\n  } catch (_a) {\n    // Node couldn't find it, so it must be user-aliased\n    callback();\n  }\n}","map":{"version":3,"sources":["/Users/abdillahihussein/Documents/GitHub/angularProject/node_modules/@angular-devkit/build-angular/src/webpack/configs/server.js"],"names":["Object","defineProperty","exports","value","getServerConfig","path_1","require","webpack_1","webpack_version_1","helpers_1","wco","buildOptions","sourceMap","bundleDependencies","externalDependencies","extraPlugins","scripts","styles","hidden","push","getSourceMapDevTool","externals","isWebpackFiveOrHigher","hook","callback","context","request","externalizePackages","config","resolve","mainFields","target","output","libraryTarget","plugins","ContextReplacementPlugin","node","startsWith","isAbsolute","paths","undefined","_a"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getServerConfig = void 0;\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nconst path_1 = require(\"path\");\nconst webpack_1 = require(\"webpack\");\nconst webpack_version_1 = require(\"../../utils/webpack-version\");\nconst helpers_1 = require(\"../utils/helpers\");\n/**\n * Returns a partial Webpack configuration specific to creating a bundle for node\n * @param wco Options which include the build options and app config\n */\nfunction getServerConfig(wco) {\n    const { sourceMap, bundleDependencies, externalDependencies = [], } = wco.buildOptions;\n    const extraPlugins = [];\n    const { scripts, styles, hidden } = sourceMap;\n    if (scripts || styles) {\n        extraPlugins.push(helpers_1.getSourceMapDevTool(scripts, styles, hidden));\n    }\n    const externals = [...externalDependencies];\n    if (!bundleDependencies) {\n        if (webpack_version_1.isWebpackFiveOrHigher()) {\n            const hook = ({ context, request }, callback) => externalizePackages(request, context, callback);\n            externals.push(hook);\n        }\n        else {\n            externals.push(externalizePackages);\n        }\n    }\n    const config = {\n        resolve: {\n            mainFields: ['es2015', 'main', 'module'],\n        },\n        target: 'node',\n        output: {\n            libraryTarget: 'commonjs',\n        },\n        plugins: [\n            // Fixes Critical dependency: the request of a dependency is an expression\n            new webpack_1.ContextReplacementPlugin(/@?hapi(\\\\|\\/)/),\n            new webpack_1.ContextReplacementPlugin(/express(\\\\|\\/)/),\n            ...extraPlugins,\n        ],\n        node: false,\n        externals,\n    };\n    return config;\n}\nexports.getServerConfig = getServerConfig;\nfunction externalizePackages(context, request, callback) {\n    // Absolute & Relative paths are not externals\n    if (request.startsWith('.') || path_1.isAbsolute(request)) {\n        callback();\n        return;\n    }\n    try {\n        require.resolve(request, { paths: [context] });\n        callback(undefined, request);\n    }\n    catch (_a) {\n        // Node couldn't find it, so it must be user-aliased\n        callback();\n    }\n}\n"]},"metadata":{},"sourceType":"script"}