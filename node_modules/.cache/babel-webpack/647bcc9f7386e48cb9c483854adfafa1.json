{"ast":null,"code":"/**\n * Copyright (c) 2015-present, Waysact Pty Ltd\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nvar Template = require('webpack/lib/Template');\n\nvar util = require('./util');\n\nvar webpackVersionComponents = require('webpack/package.json').version.split('.');\n\nvar webpackVersionMajor = Number(webpackVersionComponents[0]);\n\nfunction WebIntegrityJsonpMainTemplatePlugin(sriPlugin, compilation) {\n  this.sriPlugin = sriPlugin;\n  this.compilation = compilation;\n}\n\nWebIntegrityJsonpMainTemplatePlugin.prototype.addSriHashes = function addSriHashes(mainTemplate, source, chunk) {\n  var allChunks = util.findChunks(chunk);\n  var includedChunks = chunk.getChunkMaps().hash;\n  var hashFuncNames = this.sriPlugin.options.hashFuncNames;\n\n  if (Object.keys(includedChunks).length > 0) {\n    return (Template.asString || mainTemplate.asString)([source, '__webpack_require__.sriHashes = ' + JSON.stringify(Array.from(allChunks).reduce(function chunkIdReducer(sriHashes, depChunk) {\n      if (includedChunks[depChunk.id.toString()]) {\n        // eslint-disable-next-line no-param-reassign\n        sriHashes[depChunk.id] = util.makePlaceholder(hashFuncNames, depChunk.id);\n      }\n\n      return sriHashes;\n    }, {})) + ';']);\n  }\n\n  return source;\n};\n/*\n *  Patch jsonp-script code to add the integrity attribute.\n */\n\n\nWebIntegrityJsonpMainTemplatePlugin.prototype.addAttribute = function addAttribute(mainTemplate, elName, source) {\n  var outputOptions = this.compilation.outputOptions || mainTemplate.outputOptions;\n\n  if (!outputOptions.crossOriginLoading) {\n    this.sriPlugin.errorOnce(this.compilation, 'webpack option output.crossOriginLoading not set, code splitting will not work!');\n  }\n\n  return (Template.asString || mainTemplate.asString)([source, elName + '.integrity = __webpack_require__.sriHashes[' + (webpackVersionMajor >= 5 && elName === 'script' ? 'key.match(/^chunk-([0-9]+)$/)[1]' : 'chunkId') + '];', elName + '.crossOrigin = ' + JSON.stringify(outputOptions.crossOriginLoading) + ';']);\n};\n\nWebIntegrityJsonpMainTemplatePlugin.prototype.apply = function apply(mainTemplate) {\n  var jsonpScriptPlugin = this.addAttribute.bind(this, mainTemplate, \"script\");\n  var linkPreloadPlugin = this.addAttribute.bind(this, mainTemplate, \"link\");\n  var addSriHashes = this.addSriHashes.bind(this, mainTemplate);\n\n  if (this.compilation.compiler.options.target !== 'web') {\n    this.sriPlugin.warnOnce(this.compilation, 'This plugin is not useful for non-web targets.');\n    return;\n  }\n\n  if (mainTemplate.hooks) {\n    mainTemplate.hooks.jsonpScript.tap('SriPlugin', jsonpScriptPlugin);\n    mainTemplate.hooks.linkPreload.tap('SriPlugin', linkPreloadPlugin);\n    mainTemplate.hooks.localVars.tap('SriPlugin', addSriHashes);\n  } else {\n    mainTemplate.plugin('jsonp-script', jsonpScriptPlugin);\n    mainTemplate.plugin('local-vars', addSriHashes);\n  }\n};\n\nmodule.exports = WebIntegrityJsonpMainTemplatePlugin;","map":{"version":3,"sources":["/Users/abdillahihussein/Documents/GitHub/angularProject/node_modules/webpack-subresource-integrity/jmtp.js"],"names":["Template","require","util","webpackVersionComponents","version","split","webpackVersionMajor","Number","WebIntegrityJsonpMainTemplatePlugin","sriPlugin","compilation","prototype","addSriHashes","mainTemplate","source","chunk","allChunks","findChunks","includedChunks","getChunkMaps","hash","hashFuncNames","options","Object","keys","length","asString","JSON","stringify","Array","from","reduce","chunkIdReducer","sriHashes","depChunk","id","toString","makePlaceholder","addAttribute","elName","outputOptions","crossOriginLoading","errorOnce","apply","jsonpScriptPlugin","bind","linkPreloadPlugin","compiler","target","warnOnce","hooks","jsonpScript","tap","linkPreload","localVars","plugin","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2015-present, Waysact Pty Ltd\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar Template = require('webpack/lib/Template');\nvar util = require('./util');\nvar webpackVersionComponents = require('webpack/package.json').version.split(\n  '.'\n);\nvar webpackVersionMajor = Number(webpackVersionComponents[0]);\n\nfunction WebIntegrityJsonpMainTemplatePlugin(sriPlugin, compilation) {\n  this.sriPlugin = sriPlugin;\n  this.compilation = compilation;\n}\n\nWebIntegrityJsonpMainTemplatePlugin.prototype.addSriHashes =\n  function addSriHashes(mainTemplate, source, chunk) {\n    var allChunks = util.findChunks(chunk);\n    var includedChunks = chunk.getChunkMaps().hash;\n    var hashFuncNames = this.sriPlugin.options.hashFuncNames;\n\n    if (Object.keys(includedChunks).length > 0) {\n      return (Template.asString || mainTemplate.asString)([\n        source,\n        '__webpack_require__.sriHashes = ' +\n          JSON.stringify(\n            Array.from(allChunks).reduce(function chunkIdReducer(\n              sriHashes,\n              depChunk\n            ) {\n              if (includedChunks[depChunk.id.toString()]) {\n                // eslint-disable-next-line no-param-reassign\n                sriHashes[depChunk.id] = util.makePlaceholder(hashFuncNames, depChunk.id);\n              }\n              return sriHashes;\n            },\n                                         {})\n          ) +\n          ';'\n      ]);\n    }\n\n    return source;\n  };\n\n/*\n *  Patch jsonp-script code to add the integrity attribute.\n */\nWebIntegrityJsonpMainTemplatePlugin.prototype.addAttribute =\n  function addAttribute(mainTemplate, elName, source) {\n    const outputOptions = this.compilation.outputOptions || mainTemplate.outputOptions;\n    if (!outputOptions.crossOriginLoading) {\n      this.sriPlugin.errorOnce(\n        this.compilation,\n        'webpack option output.crossOriginLoading not set, code splitting will not work!'\n      );\n    }\n\n    return (Template.asString || mainTemplate.asString)([\n      source,\n      elName + '.integrity = __webpack_require__.sriHashes[' +\n        ((webpackVersionMajor >= 5 && elName === 'script') ? 'key.match(/^chunk-([0-9]+)$/)[1]' : 'chunkId') +\n        '];',\n      elName + '.crossOrigin = ' + JSON.stringify(outputOptions.crossOriginLoading) + ';',\n    ]);\n  };\n\nWebIntegrityJsonpMainTemplatePlugin.prototype.apply = function apply(\n  mainTemplate\n) {\n  var jsonpScriptPlugin = this.addAttribute.bind(this, mainTemplate, \"script\");\n  var linkPreloadPlugin = this.addAttribute.bind(this, mainTemplate, \"link\");\n  var addSriHashes = this.addSriHashes.bind(this, mainTemplate);\n\n  if (this.compilation.compiler.options.target !== 'web') {\n    this.sriPlugin.warnOnce(\n      this.compilation,\n      'This plugin is not useful for non-web targets.'\n    );\n    return;\n  }\n\n  if (mainTemplate.hooks) {\n    mainTemplate.hooks.jsonpScript.tap('SriPlugin', jsonpScriptPlugin);\n    mainTemplate.hooks.linkPreload.tap('SriPlugin', linkPreloadPlugin);\n    mainTemplate.hooks.localVars.tap('SriPlugin', addSriHashes);\n  } else {\n    mainTemplate.plugin('jsonp-script', jsonpScriptPlugin);\n    mainTemplate.plugin('local-vars', addSriHashes);\n  }\n};\n\nmodule.exports = WebIntegrityJsonpMainTemplatePlugin;\n"]},"metadata":{},"sourceType":"script"}